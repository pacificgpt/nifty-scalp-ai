<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description"
    content="Nifty Scalp AI â€” Upload a Nifty 1m/5m chart and get instant entry, stop-loss, and take-profit levels powered by OCR and image analysis.">
  <title>Nifty Scalp AI â€” Instant Scalp Signals</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&family=JetBrains+Mono:wght@500&display=swap"
    rel="stylesheet">
  <style>
    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    :root {
      --bg: #0a0c10;
      --surface: #12151c;
      --border: #1e2330;
      --accent: #00e676;
      --accent-dim: #00c86440;
      --red: #ff5252;
      --red-dim: #ff525230;
      --text: #e0e6ed;
      --text-dim: #7a829a;
      --radius: 14px;
    }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* ---- Header ---- */
    header {
      width: 100%;
      padding: 28px 0 8px;
      text-align: center;
    }

    header h1 {
      font-size: 2.2rem;
      font-weight: 900;
      letter-spacing: -0.03em;
      background: linear-gradient(135deg, var(--accent), #69f0ae);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    header p {
      margin-top: 6px;
      color: var(--text-dim);
      font-size: 0.95rem;
    }

    /* ---- Card ---- */
    .card {
      width: min(560px, 92vw);
      margin-top: 32px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 32px 28px;
    }

    /* ---- Upload area ---- */
    .upload-zone {
      position: relative;
      border: 2px dashed var(--border);
      border-radius: var(--radius);
      padding: 40px 20px;
      text-align: center;
      cursor: pointer;
      transition: border-color .2s, background .2s;
    }

    .upload-zone:hover,
    .upload-zone.dragover {
      border-color: var(--accent);
      background: var(--accent-dim);
    }

    .upload-zone input {
      position: absolute;
      inset: 0;
      opacity: 0;
      cursor: pointer;
    }

    .upload-zone .icon {
      font-size: 2.4rem;
    }

    .upload-zone .label {
      margin-top: 10px;
      font-size: 0.92rem;
      color: var(--text-dim);
    }

    .upload-zone .filename {
      margin-top: 8px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--accent);
      word-break: break-all;
    }

    /* ---- Button ---- */
    .btn {
      display: block;
      width: 100%;
      margin-top: 20px;
      padding: 14px;
      font-size: 1rem;
      font-weight: 700;
      letter-spacing: 0.04em;
      color: var(--bg);
      background: var(--accent);
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: transform .15s, box-shadow .2s;
    }

    .btn:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 24px var(--accent-dim);
    }

    .btn:disabled {
      opacity: .45;
      cursor: not-allowed;
    }

    /* ---- Spinner ---- */
    .spinner {
      display: none;
      margin: 24px auto 0;
      width: 40px;
      height: 40px;
      border: 4px solid var(--border);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin .7s linear infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .status-text {
      display: none;
      text-align: center;
      margin-top: 10px;
      font-size: 0.85rem;
      color: var(--text-dim);
    }

    /* ---- Results ---- */
    .result {
      display: none;
      margin-top: 28px;
      animation: fadeUp .45s ease;
    }

    @keyframes fadeUp {
      from {
        opacity: 0;
        transform: translateY(12px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .signal-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 14px;
    }

    .signal-badge {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.82rem;
      font-weight: 700;
      padding: 4px 12px;
      border-radius: 40px;
      text-transform: uppercase;
    }

    .signal-badge.buy {
      background: var(--accent-dim);
      color: var(--accent);
    }

    .signal-badge.sell {
      background: var(--red-dim);
      color: var(--red);
    }

    .signal-badge.hold {
      background: #ffffff18;
      color: var(--text-dim);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 12px;
    }

    .grid-cell {
      background: #ffffff06;
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 14px 12px;
    }

    .grid-cell .label {
      font-size: 0.72rem;
      text-transform: uppercase;
      color: var(--text-dim);
      letter-spacing: .06em;
    }

    .grid-cell .value {
      margin-top: 4px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.05rem;
      font-weight: 600;
    }

    .note {
      margin-top: 14px;
      padding: 12px 14px;
      font-size: 0.82rem;
      color: var(--text-dim);
      background: #ffffff06;
      border-left: 3px solid var(--accent);
      border-radius: 6px;
    }

    .annotated-img {
      margin-top: 18px;
      width: 100%;
      border-radius: var(--radius);
      border: 1px solid var(--border);
    }

    /* ---- Error ---- */
    .error {
      display: none;
      margin-top: 18px;
      padding: 14px;
      background: var(--red-dim);
      border: 1px solid var(--red);
      border-radius: 10px;
      font-size: 0.88rem;
      color: var(--red);
    }

    /* ---- Footer ---- */
    footer {
      margin-top: auto;
      padding: 28px 0 18px;
      font-size: 0.75rem;
      color: var(--text-dim);
    }
  </style>
</head>

<body>

  <header>
    <h1>âš¡ NIFTY SCALP AI</h1>
    <p>Upload 1m / 5m Nifty chart â†’ Entry, SL, TP in &lt; 3 sec</p>
  </header>

  <div class="card">
    <form id="uploadForm" enctype="multipart/form-data">
      <div class="upload-zone" id="dropZone">
        <div class="icon">ðŸ“Š</div>
        <div class="label">Drop chart image here or click to browse</div>
        <div class="filename" id="fileName"></div>
        <input type="file" id="chartInput" name="chart" accept="image/*" required>
      </div>
      <button class="btn" type="submit" id="analyzeBtn">ANALYZE CHART</button>
    </form>

    <div class="spinner" id="spinner"></div>
    <div class="status-text" id="statusText">Analyzing chart with OCRâ€¦ this may take a moment</div>
    <div class="error" id="errorBox"></div>
    <div class="result" id="result"></div>
  </div>

  <footer>Nifty Scalp AI &mdash; For educational purposes only. Not financial advice.</footer>

  <script>
    const form = document.getElementById('uploadForm');
    const input = document.getElementById('chartInput');
    const fileNameEl = document.getElementById('fileName');
    const spinner = document.getElementById('spinner');
    const statusText = document.getElementById('statusText');
    const errorBox = document.getElementById('errorBox');
    const resultBox = document.getElementById('result');
    const analyzeBtn = document.getElementById('analyzeBtn');
    const dropZone = document.getElementById('dropZone');

    // File selection display
    input.addEventListener('change', () => {
      fileNameEl.textContent = input.files[0]?.name || '';
    });

    // Drag & drop
    ['dragover', 'dragenter'].forEach(evt =>
      dropZone.addEventListener(evt, e => { e.preventDefault(); dropZone.classList.add('dragover'); })
    );
    ['dragleave', 'drop'].forEach(evt =>
      dropZone.addEventListener(evt, () => dropZone.classList.remove('dragover'))
    );
    dropZone.addEventListener('drop', e => {
      e.preventDefault();
      if (e.dataTransfer.files.length) {
        input.files = e.dataTransfer.files;
        fileNameEl.textContent = e.dataTransfer.files[0].name;
      }
    });

    // Submit
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      // Reset UI
      errorBox.style.display = 'none';
      resultBox.style.display = 'none';
      spinner.style.display = 'block';
      statusText.style.display = 'block';
      analyzeBtn.disabled = true;

      try {
        const formData = new FormData(form);
        const res = await fetch('/api/scalp', { method: 'POST', body: formData });
        const data = await res.json();

        if (!res.ok || !data.success) {
          throw new Error(data.error || 'Unknown error occurred');
        }

        const s = data.signal;
        const badgeClass = s.action === 'BUY' ? 'buy' : s.action === 'SELL' ? 'sell' : 'hold';

        resultBox.innerHTML = `
        <div class="signal-header">
          <span class="signal-badge ${badgeClass}">${s.action}</span>
          <span style="font-size:.82rem;color:var(--text-dim)">R:R ${s.riskReward} &bull; ${s.confidence}% confidence</span>
        </div>
        <div class="grid">
          <div class="grid-cell"><div class="label">Entry</div><div class="value" style="color:var(--accent)">${s.entry}</div></div>
          <div class="grid-cell"><div class="label">Stop Loss</div><div class="value" style="color:var(--red)">${s.stopLoss}</div></div>
          <div class="grid-cell"><div class="label">Target 1</div><div class="value">${s.target1}</div></div>
          <div class="grid-cell"><div class="label">Target 2</div><div class="value">${s.target2}</div></div>
          <div class="grid-cell"><div class="label">Support</div><div class="value">${s.support || 'N/A'}</div></div>
          <div class="grid-cell"><div class="label">Resistance</div><div class="value">${s.resistance || 'N/A'}</div></div>
        </div>
        <div class="note">ðŸ’¡ ${s.note}</div>
        <img class="annotated-img" src="${data.annotatedChart}?t=${Date.now()}" alt="Annotated chart" />
      `;
        resultBox.style.display = 'block';
      } catch (err) {
        errorBox.textContent = `âš  ${err.message}`;
        errorBox.style.display = 'block';
      } finally {
        spinner.style.display = 'none';
        statusText.style.display = 'none';
        analyzeBtn.disabled = false;
      }
    });
  </script>
</body>

</html>